---
title: Introducci√≥n a IR
---


# üõ°Ô∏è Introducci√≥n Respuesta a Incidentes (IR)

## 1. Contexto general: Vivimos en una superficie de ataque global

Vivimos en una sociedad digital donde cada dispositivo conectado es una puerta potencial para un atacante. Las organizaciones no solo tienen que **defender su per√≠metro**, sino tambi√©n prepararse para cuando esa defensa falle. Y **va a fallar**.

La pregunta no es *‚Äú¬øseremos atacados?‚Äù*, sino *‚Äú¬øc√≥mo responderemos cuando ocurra?‚Äù*.

!!!quote "üí¨ **Frase para la reflexi√≥n:**"
     ‚ÄúLos ataques cibern√©ticos no son eventos aislados. Son inevitables. Lo que distingue a una organizaci√≥n resiliente es su capacidad de respuesta.‚Äù 

       + Adaptado de Bruce Schneier


## ‚ö†Ô∏è 2. ¬øQu√© es un incidente de seguridad?

![](../img/amenaza-incidente-riesgo.png){: style="height:300px;width:300px"}

Un **incidente** no es simplemente una amenaza o una vulnerabilidad. Es la **materializaci√≥n del riesgo**:  
> ‚ÄúUn evento adverso real o inminente que pone en peligro la seguridad de los sistemas de informaci√≥n.‚Äù

![](../img/clasificacion-ataque-incidente.webp){: style="height:200px;width:400px"}

### Tipos de incidentes

Los incidentes de seguridad se clasifican seg√∫n su naturaleza, impacto y m√©todo de ejecuci√≥n. Estos son los principales tipos:

1. Incidentes por Malware
      - **Ejemplos**: Ransomware, spyware, troyanos, gusanos
      - **Impacto**: P√©rdida de datos, cifrado de sistemas
      - **Caso reciente**: Ataque de BlackCat/ALPHV a Change Healthcare (2024)

2. Ataques de Phishing
      - **Variantes**: Spear phishing, smishing, [BEC](https://www.cloudflare.com/es-es/learning/email-security/business-email-compromise-bec/)
      - **Objetivo**: Robo de credenciales
      - **T√°ctica com√∫n**: Correos falsos de instituciones

3. Brechas de Datos
      - **Causas**: Vulnerabilidades o errores humanos
      - **Consecuencia**: Exposici√≥n de informaci√≥n sensible
      - **Ejemplo 2024**: Filtraci√≥n de 73M registros de AT&T

4. [Ataques DoS/DDoS](https://www.stackscale.com/es/blog/ataques-ddos/)
      - **Tipos**:
        - Volum√©tricos (UDP flood)
        - Aplicaci√≥n (HTTP flood)
      - **Efecto**: Inaccesibilidad de servicios

5. Explotaci√≥n de Vulnerabilidades
      - **High-risk**: Zero-days
      - **Ejemplo cr√≠tico**: Log4Shell (CVE-2021-44228)

6. Amenazas Internas
      - **Tipos**:
        - Intencionadas (empleados maliciosos)
        - Negligentes (errores humanos)

7. Ataques a Cadena de Suministro
      - **Modus operandi**: Comprometer software leg√≠timo
      - **Ejemplo**: Ataque a Snowflake (2024)

8. Secuestro de Cuentas
      - **M√©todos**:
        - Credential stuffing
        - SIM swapping

9. Ataques IoT/OT
      - **Riesgo**: Infraestructuras cr√≠ticas
      - **Ejemplo**: Botnets como Mirai

10. Fraudes Cibern√©ticos
    - **Comunes**:
        - BEC (Business Email Compromise)
        - Cryptojacking

## Clasificaci√≥n por Gravedad

| Nivel    | Ejemplo                          |
|----------|----------------------------------|
| Cr√≠tico  | Ransomware en hospital           |
| Alto     | Filtraci√≥n datos masiva          |
| Medio    | Phishing a empleados             |
| Bajo     | Escaneo de puertos bloqueado     |


### Ejemplos reales s√≥lo en Espa√±a en 2025:
  + Enero 2025: Ataque de phishing a universitarios en Baleares
  + Enero 2025: Brecha de datos en la Guardia Civil y las Fuerzas Armadas
  + Enero 2025: Telef√≥nica sufre un ciberataque en su sistema de ticketing
  + Febrero 2025: Filtraci√≥n de datos personales en DKV
  + Marzo 2025: Quedan expuestos datos de clientes de El Corte Ingl√©s
  + Marzo 2025: Ataque prorruso a webs de diputaciones y ayuntamientos en Espa√±a
  + Abril 2025: robo de los datos de las federaciones de aut√≥nomos ATA
  + Abril 2025: La compa√±√≠a Aig√ºes de Matar√≥ sufre un ciberataque
  + Abril 2025: Ransomware dirigido al Ayuntamiento de Badajoz

M√°s detallado [aqu√≠](https://www.channelpartner.es/seguridad/principales-ciberataques-en-espana-en-2025/)


## üß© 3. ¬øPor qu√© necesitamos una respuesta estructurada?

!!!quote "üí¨ **Frase para la reflexi√≥n:**"
     ‚ÄúSecurity is not a product, but a process.‚Äù 
     ‚Äî Bruce Schneier

Afirmar que la seguridad es un proceso es una forma muy concisa de transmitir la idea de que la seguridad no puede lograrse simplemente comprando y desplegando productos o herramientas de seguridad. Por el contrario, la verdadera seguridad requiere esfuerzos continuos y exhaustivos que comprenden una amplia gama de actividades y pr√°cticas. La seguridad es un proceso din√°mico y polifac√©tico que requiere un esfuerzo coordinado y continuo. Se trata de crear un sistema resistente que debe adaptarse a los nuevos retos y amenazas a lo largo del tiempo. 

Una buena defensa no siempre puede evitar un ataque. Pero una mala respuesta **puede empeorarlo**. Un ejemplo frecuente es reiniciar un equipo infectado sin preservar evidencias, lo cual impide an√°lisis forense posterior.

Por eso, la **respuesta a incidentes** (IR) es un **proceso formal** y met√≥dico que busca:

- Minimizar impacto
- Restaurar operaciones
- Preservar evidencias
- Aprender del incidente

## üèõÔ∏è 4. Fundamentos normativos y frameworks

### üìö Normativas y est√°ndares:
- **NIST SP 800-61 rev.2**: Gu√≠a de manejo de incidentes (marco de referencia m√°s usado)
- **ISO/IEC 27035**: Est√°ndar internacional para gesti√≥n de incidentes
- **ENS (Espa√±a)**: Exige capacidades de IR a sistemas de informaci√≥n p√∫blicos
- **NIS2 (Europa)**: La NIS2 (Network and Information Security Directive 2) es una normativa de la Uni√≥n Europea que refuerza y reemplaza a la directiva original NIS (2016), ampliando sus exigencias en materia de ciberseguridad para sectores cr√≠ticos y operadores esenciales.

### üîê Ciberseguridad en capas:
La respuesta a incidentes se sit√∫a en la **√∫ltima l√≠nea de defensa**, justo despu√©s de que todas las otras capas han fallado.



## üß† 5. Ciclo de Vida de la Respuesta a Incidentes

Inspirado en NIST, el proceso se divide en fases interdependientes

![](../img/fasesIR.png)

> üìå **Nota:** Algunas organizaciones a√±aden una fase 0 (‚ÄúPreparaci√≥n estrat√©gica‚Äù) y una 6 (‚ÄúAutomatizaci√≥n y mejora continua‚Äù).

### üß∞ 1. Preparaci√≥n

La **fase de preparaci√≥n** es la **primera y m√°s cr√≠tica etapa** del ciclo de vida de la respuesta a incidentes. Su objetivo es garantizar que la organizaci√≥n est√© lista **antes de que ocurra un incidente**, minimizando su impacto y acelerando la recuperaci√≥n.

Seg√∫n NIST, una preparaci√≥n s√≥lida **marca la diferencia entre el caos y la contenci√≥n eficaz**.


### üéØ Objetivos de esta fase

- Establecer un **plan formal y claro** de actuaci√≥n ante incidentes.
- Definir roles, responsabilidades y flujos de comunicaci√≥n.
- Entrenar al personal y fortalecer la infraestructura de seguridad.
- Asegurar que existan herramientas, documentaci√≥n y procesos actualizados.


### üóÇÔ∏è Componentes clave de la preparaci√≥n

#### ‚úÖ 1.1 Plan de Respuesta a Incidentes (IRP)
- Documento estrat√©gico y operativo que define **qu√© hacer, qui√©n lo hace y c√≥mo** ante distintos tipos de incidentes.
- Debe incluir procedimientos, taxonom√≠a, criterios de severidad, matrices de escalado y canales de comunicaci√≥n.
- Debe actualizarse al menos **una vez al a√±o** o tras incidentes cr√≠ticos.

#### üë• 1.2 Creaci√≥n del CSIRT / IRT
- Un **Computer Security Incident Response Team** o **equipo de respuesta** puede ser interno, mixto o subcontratado.
- Composici√≥n multidisciplinar: ciberseguridad, legal, TI, RRHH, comunicaci√≥n.
- Debe tener autoridad, herramientas y l√≠neas de comunicaci√≥n directa con la direcci√≥n.

#### üìú 1.3 Pol√≠ticas, normas y procedimientos
- Pol√≠tica de gesti√≥n de incidentes (qui√©n reporta, tiempos de notificaci√≥n, etc.).
- Pol√≠ticas relacionadas: uso aceptable, control de accesos, clasificaci√≥n de la informaci√≥n.
- Procedimientos operativos normalizados (SOP): recuperaci√≥n de sistemas, aislamiento de red, backup seguro.

#### üñ•Ô∏è 1.4 Inventario y clasificaci√≥n de activos
- Listado actualizado de **sistemas cr√≠ticos, redes, datos sensibles y proveedores clave**.
- Identificaci√≥n de sistemas que requieren **protecci√≥n reforzada** (seg√∫n ENS, RGPD, etc.).

#### üìû 1.5 Canales de comunicaci√≥n establecidos
- Definici√≥n de contactos internos (SOC, IT, CISO, legales) y externos (CERT/CC, proveedores, polic√≠a).
- [Protocolos de comunicaci√≥n en caso de contingencia](https://www.xataka.com/servicios/que-nos-quedaramos-movil-durante-apagon-fue-terrible-que-le-pasara-al-gobierno-mucho-preocupante) (email alternativo, m√≥viles, canales encriptados).

#### üß™ 1.6 Formaci√≥n y simulacros
- Formaci√≥n continua del personal t√©cnico y no t√©cnico.
- **Ejercicios tipo Tabletop**: simulaci√≥n en sala para discutir respuestas.
- **Red Team / Blue Team**: ejercicios ofensivos y defensivos realistas para poner a prueba planes.
- Lecciones aprendidas de cada simulacro ‚Üí mejoras en IRP y formaci√≥n.


### üõ†Ô∏è Buenas pr√°cticas

- Disponer de herramientas EDR, SIEM o ticketing ya preconfiguradas.
- Establecer m√©tricas para evaluar la preparaci√≥n (MTTD, MTTR).

      ‚è±Ô∏è Tipos de Tiempos que se Miden en Respuesta a Incidentes (IR)

      ### ‚è±Ô∏è Tipos de Tiempos que se Miden en Respuesta a Incidentes (IR)

| Tiempo                      | Definici√≥n                                                                 | Importancia                                                                 |
|-----------------------------|---------------------------------------------------------------------------|------------------------------------------------------------------------------|
| **MTTD** (Mean Time to Detect)     | Tiempo medio desde que ocurre un incidente hasta que se detecta.         | Eval√∫a la eficacia de las herramientas de detecci√≥n y monitorizaci√≥n.       |
| **MTTI** (Mean Time to Identify)   | Tiempo medio desde la detecci√≥n hasta confirmar que es un incidente.     | Refleja la capacidad de an√°lisis y clasificaci√≥n del equipo.                |
| **MTTR** (Mean Time to Respond)    | Tiempo medio desde la identificaci√≥n hasta iniciar la respuesta.         | Mide la agilidad de reacci√≥n del CSIRT.                                     |
| **MTTC** (Mean Time to Contain)    | Tiempo medio desde la detecci√≥n hasta contener completamente el incidente.| Indica rapidez para controlar la amenaza.                                   |
| **MTTE** (Mean Time to Eradicate)  | Tiempo medio para eliminar la causa ra√≠z (malware, acceso, vulnerabilidad).| Eval√∫a eficiencia en limpieza y erradicaci√≥n.                               |
| **MTTR** (Mean Time to Recover)    | Tiempo medio para restaurar el sistema a su estado operativo normal.      | Refleja la resiliencia y capacidad de recuperaci√≥n.                         |
| **TTR** (Time to Report)           | Tiempo desde la detecci√≥n hasta la notificaci√≥n oficial del incidente.    | Clave para cumplimiento legal (RGPD, ENS, NIS2, etc.).                      |
| **Time to Learn**                  | Tiempo desde la resoluci√≥n hasta la incorporaci√≥n de mejoras.             | Mide madurez organizativa y aprendizaje post-incidente.                     |


- Alinear la preparaci√≥n con normativas como el **ENS**, la **NIS2**, y **ISO 27035**.
- Hacer **pruebas cruzadas** con otras funciones: continuidad del negocio, protecci√≥n de datos, etc.


### üìå Resultado esperado

Una organizaci√≥n preparada:

  - Tiene **procedimientos documentados y conocidos** por todos los actores.
  - Puede **responder de forma ordenada, r√°pida y efectiva**.
  - Reduce riesgos legales, reputacionales y econ√≥micos ante cualquier incidente.

### üîé 2. Detecci√≥n y an√°lisis

La **fase de detecci√≥n y an√°lisis** es el punto en el que una organizaci√≥n **reconoce una posible amenaza** y comienza a investigarla. Esta etapa es **cr√≠tica para reducir el tiempo de respuesta** y evitar que el incidente escale.

> Una buena detecci√≥n solo es posible si la fase de preparaci√≥n se ha ejecutado correctamente.

---

### üß≠ Objetivos de la fase

- Identificar actividades an√≥malas o maliciosas en tiempo y forma.
- Correlacionar eventos para determinar si constituyen un incidente.
- Clasificar el incidente, evaluando su **gravedad e impacto**.
- Activar el plan de respuesta correspondiente.

---

### üß∞ Herramientas clave para la detecci√≥n

| Herramienta / Tecnolog√≠a | Funci√≥n principal                                 |
|--------------------------|--------------------------------------------------|
| **SIEM** (Security Information and Event Management) | Recolecta, centraliza y correlaciona logs de m√∫ltiples fuentes. |
| **IDS/IPS** (Intrusion Detection/Prevention Systems) | Detecta y/o bloquea tr√°fico malicioso en la red. |
| **EDR/XDR** (Endpoint/Extended Detection and Response) | Supervisa y responde a amenazas en endpoints (PCs, servidores, etc.). |
| **Logs y auditor√≠a** | Registro detallado de eventos en sistemas, aplicaciones y redes. |
| **Herramientas de threat intelligence** | Enriquecen alertas con datos sobre actores y campa√±as conocidas. |


### üîÑ Proceso t√≠pico de an√°lisis

1. **Recolecci√≥n de alertas o indicadores**
      - Las alertas pueden provenir de sensores autom√°ticos (SIEM, EDR), usuarios finales, proveedores, etc.

2. **Correlaci√≥n y contextualizaci√≥n**
      - El analista revisa patrones y relaciones entre eventos: ¬øse trata de una secuencia aleatoria o una amenaza organizada?

3. **Verificaci√≥n**
      - No toda alerta es un incidente. Muchas son falsos positivos. Hay que confirmar:  
        - ¬øEs un incidente real?
        - ¬øQu√© sistemas est√°n afectados?
        - ¬øCu√°l es el vector de ataque?

4. **Clasificaci√≥n mediante taxonom√≠a**
      - Se asigna una categor√≠a y subcategor√≠a al incidente seg√∫n su naturaleza (malware, fuga de datos, DDoS‚Ä¶).
      - Tambi√©n se determina su **nivel de criticidad** (bajo, medio, alto, cr√≠tico).
      - Esto permite seleccionar el **playbook** adecuado para la respuesta.

5. **Registro del incidente**
      - Se documenta en una base de datos o herramienta de ticketing, incluyendo:
        - Hora de detecci√≥n
        - Fuente
        - Clasificaci√≥n
        - Responsable asignado
        - Acciones iniciales tomadas

---

### üìä Criterios de severidad (ejemplo)

| Nivel | Descripci√≥n                                 | Ejemplo                              |
|-------|---------------------------------------------|--------------------------------------|
| Bajo  | No afecta sistemas cr√≠ticos, impacto menor  | Usuario abre phishing pero no clickea |
| Medio | Afecta a usuarios individuales o servicios secundarios | Malware aislado en un PC         |
| Alto  | Afecta sistemas clave o datos sensibles     | Exfiltraci√≥n de datos con impacto legal |
| Cr√≠tico | Amenaza para toda la organizaci√≥n         | Ransomware en m√∫ltiples servidores clave |

---

### üß± Rol de la taxonom√≠a de incidentes

Durante esta fase se utiliza una **taxonom√≠a estructurada** para clasificar el incidente correctamente.  
Esto facilita:

- Escalar correctamente el incidente.
- Activar el procedimiento (playbook) adecuado.
- Obtener estad√≠sticas y reportes consistentes.
- Cumplir con requisitos regulatorios (ENS, NIS2, ISO 27035‚Ä¶).

> üìå *M√°s adelante profundizaremos en la taxonom√≠a de incidentes.*

---

### ‚ö†Ô∏è Ejemplo real

> üîî Un EDR detecta la ejecuci√≥n de un script PowerShell cifrado en un servidor interno.

üìå Proceso:

  - El evento llega al SIEM y se correlaciona con una conexi√≥n sospechosa saliente.
  - Se identifica como posible malware con comportamiento de exfiltraci√≥n.
  - El analista lo clasifica como:
    - Categor√≠a: **Malware**
    - Subcategor√≠a: **Downloader + Exfiltraci√≥n**
    - Severidad: **Alta**
  - Se activa el playbook de contenci√≥n de malware y se notifica a la direcci√≥n.

---

### üß† Conclusi√≥n

Una detecci√≥n eficaz requiere:

  - **Visibilidad completa del entorno**
  - **Herramientas adecuadas de monitoreo**
  - Analistas capacitados y documentaci√≥n clara
  - Coordinaci√≥n con la fase de preparaci√≥n

Una mala detecci√≥n puede convertir un incidente leve en una **crisis mayor**.

## üõë 3. Fase de Contenci√≥n

Una vez confirmado el incidente, la prioridad es **limitar su alcance y da√±o** lo antes posible. Esta fase consiste en **detener la propagaci√≥n**, evitar la p√©rdida de informaci√≥n y **proteger los activos cr√≠ticos**.

### üéØ Objetivos
- Minimizar el impacto del incidente.
- Proteger sistemas no afectados.
- Ganar tiempo para investigar y planificar la recuperaci√≥n.


### ‚öôÔ∏è Tipos de contenci√≥n

#### üìç Contenci√≥n a corto plazo
- **Acci√≥n inmediata** para aislar o desconectar sistemas afectados.
  - Ejemplos:
    - Quitar de la red el equipo comprometido.
    - Bloquear direcciones IP sospechosas en el firewall.
    - Cerrar sesiones activas del atacante.

#### üß© Contenci√≥n a largo plazo
- Acciones que preparan el sistema para **una recuperaci√≥n segura**.
  - Ejemplos:
    - Aplicaci√≥n de parches de seguridad.
    - Cambio de credenciales comprometidas.
    - Reconfiguraci√≥n de servicios expuestos.

> ‚ö†Ô∏è ¬°Ojo! Actuar demasiado r√°pido sin an√°lisis puede destruir evidencias forenses.

### üß† Requiere:
- Decisiones r√°pidas pero **estrat√©gicas y justificadas**.
- Coordinaci√≥n entre CSIRT, legal y TI.
- Consideraci√≥n del impacto operacional y reputacional.

## üßπ 4. Fase de Erradicaci√≥n y Recuperaci√≥n

Con el incidente contenido, es hora de **eliminar cualquier rastro de la amenaza** y restaurar los sistemas afectados de forma segura.

### üîç Erradicaci√≥n
- **Eliminar el malware**, herramientas del atacante, cuentas no autorizadas o backdoors.
- **Buscar persistencia**: el atacante podr√≠a haber instalado mecanismos para volver a entrar.
- Comprobar los **registros y hashes** para validar que no quedan trazas.

### üß™ Verificaci√≥n
- Escaneo de sistemas con antivirus/EDR actualizados.
- An√°lisis de logs y tr√°fico de red post-incidente.
- Validaci√≥n de integridad (checksums, firmas digitales‚Ä¶).


### ‚ôªÔ∏è Recuperaci√≥n
- Restaurar servicios desde **backups verificados**.
- Aplicar **actualizaciones y configuraciones reforzadas**.
- **Reincorporar** los sistemas a la red solo cuando est√©n validados.
- Realizar **pruebas funcionales y de seguridad**.


### ‚úÖ Objetivo final
Volver a la normalidad **con garant√≠as de que la amenaza ha sido eliminada** y no puede repetirse por el mismo vector.


## üìã 5. Fase de Lecciones Aprendidas

Una vez resuelto el incidente, es fundamental **reflexionar sobre lo ocurrido** para mejorar las capacidades futuras.

> Esta fase a menudo se olvida‚Ä¶ ¬°pero es la que convierte el error en mejora continua!


### üß† Actividades clave

#### üßæ 5.1 An√°lisis post-mortem (retrospectiva)

  - ¬øQu√© sucedi√≥ exactamente?
  - ¬øC√≥mo se detect√≥ y respondi√≥?
  - ¬øQu√© funcion√≥ y qu√© no?
  - ¬øQu√© se podr√≠a haber hecho mejor?

#### üìà 5.2 Mejora de controles y procesos

  - Actualizar pol√≠ticas y procedimientos.
  - Ajustar configuraciones de seguridad (firewall, roles, alertas‚Ä¶).
  - Invertir en herramientas o formaci√≥n si se identificaron carencias.

#### ü™™ 5.3 Documentaci√≥n formal

  - Redacci√≥n de informes internos y ejecutivos.
  - Registro en sistemas de ticketing o bases de datos de incidentes.
  - Informe a autoridades si es obligatorio (ej. AEPD, CCN-CERT).

#### üìö 5.4 Actualizaci√≥n del plan IRP y formaci√≥n

  - Modificaci√≥n del Plan de Respuesta a Incidentes.
  - Inclusi√≥n del incidente como **caso de estudio** para futuras formaciones.


### üìå Resultado esperado

Una organizaci√≥n resiliente:

  - Aprende de cada incidente.
  - Mejora continuamente su postura de ciberseguridad.
  - Reduce el riesgo de que un incidente similar vuelva a ocurrir.


### üë®‚Äçüíª 6. Roles del Equipo de Respuesta a Incidentes (CSIRT)

Un equipo efectivo de respuesta a incidentes est√° compuesto por perfiles t√©cnicos y estrat√©gicos que colaboran de forma coordinada. Cada rol tiene funciones bien definidas para asegurar una respuesta eficiente y controlada.

| Rol                            | Funciones Principales                                                                 |
|--------------------------------|----------------------------------------------------------------------------------------|
| **SOC Analyst (Nivel 1/2/3)**  | - Monitorizaci√≥n continua de alertas.<br> - Triaje inicial de incidentes.<br> - Contenci√≥n b√°sica. |
| **Incident Responder**         | - Investigaci√≥n en profundidad.<br> - An√°lisis forense b√°sico.<br> - Coordinaci√≥n t√©cnica. |
| **Forensic Analyst**           | - An√°lisis de memoria, discos, logs.<br> - Preservaci√≥n de evidencias.<br> - Apoyo en procesos legales. |
| **Threat Hunter**              | - Detecci√≥n proactiva de amenazas.<br> - An√°lisis de TTPs (MITRE ATT&CK).<br> - Mejora de alertado. |
| **CSIRT Manager**              | - Liderazgo del equipo.<br> - Comunicaci√≥n con stakeholders.<br> - Priorizaci√≥n de incidentes. |
| **Malware Analyst**            | - Reversing de malware.<br> - An√°lisis est√°tico y din√°mico.<br> - Creaci√≥n de firmas (YARA, Snort). |
| **Threat Intelligence Analyst**| - Recolecci√≥n de inteligencia de amenazas.<br> - Enlace con fuentes externas.<br> - Informes y enriquecimiento de alertas. |
| **Communications Officer**     | - Gesti√≥n de la comunicaci√≥n interna y externa.<br> - Comunicaci√≥n de crisis.<br> - Informes a reguladores o clientes. |
| **Legal/Compliance Advisor**   | - Cumplimiento normativo (ENS, NIS2, RGPD).<br> - Gesti√≥n legal de notificaciones y brechas. |
| **IT/Network Specialist**      | - Aplicaci√≥n de contramedidas t√©cnicas.<br> - Hardening y reconfiguraci√≥n de red.<br> - Coordinaci√≥n con sistemas. |


## üîß 7. Herramientas Clave para Respuesta a Incidentes

| Categor√≠a        | Herramientas Comunes                                |
|------------------|------------------------------------------------------|
| **SIEM**         | Splunk, Wazuh, IBM QRadar                            |
| **EDR/XDR**      | CrowdStrike, SentinelOne, Microsoft Defender         |
| **An√°lisis Forense** | Autopsy, FTK Imager, Volatility                     |
| **Sandboxing**   | Cuckoo Sandbox, Any.Run                              |
| **Threat Intel** | MISP, VirusTotal, Intel 471                          |
| **SOAR**         | TheHive + Cortex, Shuffle, Splunk SOAR, IBM Resilient |


## üß† 8. Cultura de Seguridad y Detecci√≥n Temprana

Una respuesta efectiva comienza **mucho antes** de la detecci√≥n del incidente. La cultura organizativa es clave para prevenir y responder eficazmente.

### üìå Principios fundamentales:
- **Formaci√≥n continua** de usuarios y t√©cnicos.
- El **usuario final puede ser el primer sensor** de amenazas.
- Fomentar una cultura de **reporte sin miedo ni represalias**.
- Integrar la ciberseguridad en todos los niveles de la organizaci√≥n.


## üìò 9. ¬øQu√© es un Playbook de Respuesta a Incidentes?

Un **playbook** es un procedimiento detallado, estructurado y reutilizable que define **qu√© hacer paso a paso ante un tipo espec√≠fico de incidente**. Sirve como gu√≠a para actuar con rapidez, coherencia y eficacia.

### üß≠ ¬øPor qu√© usar playbooks?

- Estandarizan la respuesta.
- Aumentan la agilidad del equipo.
- Facilitan el entrenamiento y la transferencia de conocimiento.
- Sirven de base para la automatizaci√≥n con SOAR.


## üß© 10. Componentes T√≠picos de un Playbook

| Componente                | Descripci√≥n                                                                            |
|---------------------------|----------------------------------------------------------------------------------------|
| **Nombre del incidente**  | Tipo de incidente tratado (phishing, ransomware, fuga de datos‚Ä¶).                     |
| **Objetivo**              | Qu√© se espera lograr con la respuesta.                                                 |
| **Indicadores (IoCs)**    | Se√±ales observables del incidente (hashes, IPs, dominios...).                         |
| **Fases de respuesta**    | Qu√© hacer en cada etapa (detecci√≥n, contenci√≥n, erradicaci√≥n‚Ä¶).                       |
| **Roles asignados**       | Qui√©n debe realizar cada tarea.                                                       |
| **Checklists operativas** | Acciones concretas: comandos, an√°lisis, aislamiento, herramientas a utilizar.         |
| **Notificaciones**        | A qui√©n avisar: CISO, DPO, RRHH, usuarios afectados, autoridades, etc.                |
| **Referencias legales**   | Obligaciones de notificaci√≥n seg√∫n ENS, RGPD, NIS2, etc.                              |
| **Lecciones aprendidas**  | Cambios a realizar tras el incidente o ensayo.                                        |


## üõ†Ô∏è 12. Ejemplo Breve: Playbook de Phishing

```yaml
Nombre: Phishing por correo
Objetivo: Evitar propagaci√≥n, identificar afectados, contener amenaza.
Fase 1: Confirmaci√≥n ‚Üí Revisar encabezado, verificar URLs, analizar adjunto.
Fase 2: Contenci√≥n ‚Üí Bloquear URL/IP en proxy/firewall, revocar accesos comprometidos.
Fase 3: Erradicaci√≥n ‚Üí Eliminar email de bandejas, forzar cambio de contrase√±as.
Fase 4: Notificaci√≥n ‚Üí CISO, RRHH, usuarios afectados.
Fase 5: Mejora ‚Üí Revisar filtros de correo, reforzar formaci√≥n.
```

## 13. üîÅ 13. Relaci√≥n con SOAR y Automatizaci√≥n

Una vez definidos, los playbooks pueden automatizarse mediante herramientas SOAR (Security Orchestration, Automation and Response).

Estas plataformas integran sistemas, ejecutan tareas autom√°ticamente y permiten a los analistas centrarse en la toma de decisiones cr√≠ticas.

### üõ†Ô∏è Plataformas SOAR populares:

+ TheHive + Cortex: Open-source, modular, muy usado en Europa.

+ Splunk SOAR: Integrado con Splunk SIEM.

+ IBM Resilient: Potente y enfocado en entornos regulados.

### üìå Acciones t√≠picas automatizables:

  + Cuarentena de un equipo desde EDR.

  + Env√≠o autom√°tico de alertas por correo o Slack.

  + B√∫squeda de IoCs en m√∫ltiples fuentes.

  + Registro del incidente en el sistema de ticketing.

  + La automatizaci√≥n bien aplicada reduce el tiempo de respuesta y el desgaste del equipo.


## üíº 14. Taxonom√≠a de incidentes

La taxonom√≠a de incidentes es un sistema de clasificaci√≥n que permite categorizar los incidentes de seguridad en sistemas seg√∫n su origen, impacto, t√©cnicas utilizadas y vectores de ataque. Su objetivo es estandarizar el lenguaje en la respuesta a incidentes (IR) y facilitar el an√°lisis forense, la contenci√≥n y la remediaci√≥n.

A continuaci√≥n, se presenta una taxonom√≠a t√©cnica centrada en sistemas, basada en marcos como MITRE ATT&CK, CWE (Common Weakness Enumeration) y NIST SP 800-61.

### 1. ¬øPor qu√© Usar una Taxonom√≠a?
- **Estandarizaci√≥n:** Lenguaje com√∫n para describir incidentes
- **Priorizaci√≥n:** Determinar criticidad (ej: ransomware > escaneo de puertos)
- **Mejora continua:** Generaci√≥n de m√©tricas para an√°lisis

### 2. Taxonom√≠a Basada en Sistemas

#### A. Por Tipo de Ataque
| Categor√≠a           | Ejemplos T√©cnicos                     | Indicadores Clave (IOCs)               |
|---------------------|--------------------------------------|----------------------------------------|
| Malware             | Ransomware, rootkits, backdoors      | Hashes de archivos, conexiones C2      |
| Explotaci√≥n de SW   | Vulnerabilidades (Log4j, ProxyShell) | Logs de errores, ejecuci√≥n de payloads |
| Credential Theft    | Pass-the-Hash, Kerberoasting         | Eventos 4625 (Windows)                 |

#### B. Por Impacto en Sistemas
| Nivel    | Definici√≥n                          | Ejemplo                          |
|----------|------------------------------------|----------------------------------|
| Cr√≠tico  | Compromete toda la infraestructura | Ransomware en servidores         |
| Alto     | Afecta m√∫ltiples sistemas          | Dominio AD comprometido          |

#### C. Por Vector de Inicializaci√≥n
| Vector   | Descripci√≥n                  | Ejemplo en Sistemas           |
|----------|-----------------------------|-------------------------------|
| Remoto   | Ataque desde red externa     | Explotaci√≥n de VPN            |
| Local    | Ejecuci√≥n desde dentro       | USB infectado                 |

### 3. Taxonom√≠as de Referencia

#### A. MITRE ATT&CK
- **T√°ctica:** Persistence ‚Üí **T√©cnica:** Scheduled Task
- Ejemplo: `schtasks /create`

#### B. CWE (Common Weakness Enumeration)
- **CWE-89:** SQL Injection ‚Üí Ataque a bases de datos

#### C. NIST SP 800-61
- Categor√≠as: DoS, Unauthorized Access

### 4. Aplicaci√≥n Pr√°ctica en IR

#### Paso 1: Clasificar el Incidente

- **Tipo:** Malware (Ransomware)
- **Impacto:** Cr√≠tico
- **Vector:** Remoto (RDP expuesto)

#### Paso 2: Respuesta T√©cnica

  + **Contenci√≥n:** Bloquear IPs maliciosas

  + **Erradicaci√≥n:** Eliminar tareas programadas (T1053.005 ATT&CK)

#### Paso 3: Reporte Estructurado

##### Reporte de Incidente
- **ID:** INC-2023-001
- **Taxonom√≠a:** Malware ‚Üí Ransomware (Ryuk)
- **T√©cnicas MITRE:** T1486 (Data Encrypted for Impact)

### 5. Herramientas para Automatizaci√≥n

  + MISP: Compartir IOCs

  + Splunk ES: Correlaci√≥n con ATT&CK

  + TheHive: Gesti√≥n de casos

As√≠ pues, a modo de recapitulaci√≥n, la taxonom√≠a permite:

+ ‚úî Priorizar acciones t√©cnicas

+ ‚úî Comunicaci√≥n efectiva entre equipos

+ ‚úî Integraci√≥n con marcos como ATT&CK

## üìå Conclusi√≥n

Responder a incidentes no es solo cuesti√≥n de tecnolog√≠a, sino de **personas, procesos y estrategia**. Ense√±ar a responder correctamente es tan importante como ense√±ar a prevenir.

> ‚ÄúLa preparaci√≥n es la mejor defensa, y la respuesta, la verdadera prueba de madurez en ciberseguridad.‚Äù


## Referencias

[Don‚Äôt Make These Incident Response Planning Mistakes](https://terrycutler.com/dont-make-these-incident-response-planning-mistakes/)